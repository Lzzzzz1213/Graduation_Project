<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>顾客视力信息登记页面</title>
  <meta content="webkit" name="renderer">
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <meta content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi"
        name="viewport"/>
  <link th:href="@{/css/font.css}" rel="stylesheet">
  <link th:href="@{/css/xadmin.css}" rel="stylesheet">
  <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
  <script charset="utf-8" th:src="@{/lib/layui/layui.js}"></script>
  <script th:src="@{/js/xadmin.js}" type="text/javascript"></script>
  <script th:src="@{/js/xcity.js}" type="text/javascript"></script>
  <!--[if lt IE 9]>
  <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
  <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="layui-main">
  <form action="">
    <input class="layui-input" type="hidden" name="pageIndex" value="1">
    <input class="layui-input" type="hidden" name="pageSize" value="1">
  </form>
  <div id="LAY_preview">
    <div class="layui-form layui-border-box layui-table-view">
      <div class="layui-table-box">
        <div class="layui-table-body">
          <form class="layui-form layui-form-pane" action="">

            <table border="0" cellpadding="0" cellspacing="0" class="layui-table"
                   style="text-align: center" th:each="registerinfo:${pages.list}">
              <tbody>
              <tr>
                <td colspan="9">视力美视力健康管理机构</td>
              </tr>
              <tr>
                <td colspan="6"></td>
                <td>填表日期</td>
                <td th:text="${registerinfo.registerInfo_createDate}"></td>
              </tr>
              <tr>
                <td>姓名</td>
                <td th:text="${customer.customer_name}"></td>
                <td>性别</td>
                <td th:text="${customer.customer_sex}"></td>
                <td>年龄</td>
                <td th:text="${age}"></td>
                <td>所在学校</td>
                <td width="200" th:text="${customer.customer_schoolName}"></td>
              </tr>
              <tr>
                <td>家庭住址</td>
                <td colspan="5" th:text="${customer.customer_address}"></td>
                <td>QQ号码</td>
                <td th:text="${customer.customer_qqNumber}"></td>
              </tr>
              <tr>
                <td>联系电话</td>
                <td colspan="2" th:text="${customer.customer_phoneNumber}"></td>
                <td>座机电话</td>
                <td colspan="2" th:text="${customer.customer_phoneNumber}"></td>
                <td>电子邮箱</td>
                <td th:text="${customer.customer_email}"></td>
              </tr>
              <tr>
                <td>裸眼视力</td>
                <td th:text="'右：'+${registerinfo.registerInfo_visionRight}"></td>
                <td th:text="'左：'+${registerinfo.registerInfo_visionLeft}"></td>
                <td>配镜史</td>
                <td colspan="2" th:text="${registerinfo.registerInfo_history}"></td>
                <td>镜架</td>
                <td th:text="${registerinfo.registerInfo_support}"></td>
              </tr>
              <tr>
                <td>用法</td>
                <td>球镜</td>
                <td>柱镜</td>
                <td>轴度</td>
                <td>矫正视力</td>
                <td colspan="3">瞳距</td>
              </tr>
              <tr>
                <td rowspan="2" style="padding: 0">
                  <table border="0" cellpadding="0" cellspacing="0">
                    <tr>
                      <td rowspan="2">远用</td>
                      <td>右眼</td>
                    </tr>
                    <tr>
                      <td>左眼</td>
                    </tr>
                  </table>
                </td>
                <td th:text="${registerinfo.registerInfo_loinMiroirDeBouleRight}"></td>
                <td th:text="${registerinfo.registerInfo_loinMiroirDeColonneRight}"></td>
                <td th:text="${registerinfo.registerInfo_loinAxeRight}"></td>
                <td th:text="${registerinfo.registerInfo_loinCorrectionRight}"></td>
                <td colspan="3" rowspan="4" th:text="'右眼瞳距:'+${registerinfo.registerInfo_PDRight}+'左眼瞳距:'+${registerinfo.registerInfo_PDLeft}">
                </td>
              </tr>
              <tr>
                <td th:text="${registerinfo.registerInfo_loinMiroirDeBouleLeft}"></td>
                <td th:text="${registerinfo.registerInfo_loinMiroirDeColonneLeft}"></td>
                <td th:text="${registerinfo.registerInfo_loinAxeLeft}"></td>
                <td th:text="${registerinfo.registerInfo_loinCorrectionLeft}"></td>
              </tr>
              <tr>
                <td rowspan="2" style="padding: 0">
                  <table border="0" cellpadding="0" cellspacing="0">
                    <tr>
                      <td rowspan="2">近用</td>
                      <td>右眼</td>
                    </tr>
                    <tr>
                      <td>左眼</td>
                    </tr>
                  </table>
                </td>
                <td th:text="${registerinfo.registerInfo_procheMiroirDeBouleRight}"></td>
                <td th:text="${registerinfo.registerInfo_procheMiroirDeColonneRight}"></td>
                <td th:text="${registerinfo.registerInfo_procheAxeRight}"></td>
                <td th:text="${registerinfo.registerInfo_procheCorrectionRight}"></td>
              </tr>
              <tr>
                <td th:text="${registerinfo.registerInfo_procheMiroirDeBouleLeft}"></td>
                <td th:text="${registerinfo.registerInfo_procheMiroirDeColonneLeft}"></td>
                <td th:text="${registerinfo.registerInfo_procheAxeLeft}"></td>
                <td th:text="${registerinfo.registerInfo_procheCorrectionLeft}"></td>
              </tr>
              <tr>
                <td colspan="2">
                  验光师
                </td>
                <td colspan="2" th:text="${registerinfo.registerInfo_userName}"></td>
                <td colspan="4">
                  <input hidden="hidden" th:value="${session.user.id}" name="order_userId">
                  <input hidden="hidden" th:value="${session.user.name}" name="order_userName">
                  <input hidden="hidden" th:value="${customer.customer_id}" name="order_customerId">
                  <input hidden="hidden" th:value="${customer.customer_name}" name="order_customerName">
                  <input hidden="hidden" th:value="${registerinfo.registerInfo_id}" name="order_registerInfoId">
                  <button class="layui-btn" lay-filter="submit" lay-submit="">创建订单</button>
                </td>
              </tr>
              </tbody>
            </table>
          </form>
          <div class="layui-card-body ">
            <div class="page">
              <div>
                <a class="prev" href="javascript:page_nav(document.forms[0],1);">首页</a>
                <a class="next" href="javascript:page_nav(document.forms[0],getCurrentPageNo()-1);"
                   id="last">上一页</a>
                <span class="current" th:text="${pages.pageIndex}"></span>
                <a class="next" href="javascript:page_nav(document.forms[0],getCurrentPageNo()+1);"
                   id="next">下一页</a>
                <a class="next" href="javascript:page_nav(document.forms[0],getTotalPageCount());">尾页</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
<script th:inline="javascript">
  window.onload = function (){
    var index = [[${pages.pageIndex}]];
    var total = [[${pages.pageTotalCount}]];
    if(index == 1){
      $("#last").addClass("layui-disabled");
      $("#last").removeAttr('href');
    }else{
      $("#last").removeClass("layui-disabled");
    }
    if ( index == total){
      $("#next").addClass("layui-disabled");
      $("#next").removeAttr('href');
    }else {
      $("#next").removeClass("layui-disabled");
    }
  }
</script>
<script>
  layui.use(['form'], function () {
    form = layui.form;

    form.verify({});
    form.on('submit(submit)',
            function (data) {
              console.log(data);
              createOrder(data.field);
              return false;
            });
  });


  function createOrder(data) {
    $.ajax({
      type: "POST",
      // dataType:"json",
      data: data,
      url: "http://localhost:9911/user/order/createOrder",
      success: function (data) {
        layer.alert("创建订单成功", {
                  icon: 6
                });
      },
      error: function (message) {
        layer.alert("创建订单失败，订单已存在", {
                  icon: 5
                });
      }
    })
  }
</script>
<script th:inline="javascript">
  function getCurrentPageNo(){
    var currentPageNo = [[${pages.pageIndex}]];
    return currentPageNo;
  }
  function getTotalPageCount(){
    var totalPageCount = [[${pages.pageTotalCount}]]
    return totalPageCount;
  }
</script>
<script type="text/javascript">
  function page_nav(frm,num) {
    frm.pageIndex.value = num;
    frm.submit();
  }
</script>
</html>
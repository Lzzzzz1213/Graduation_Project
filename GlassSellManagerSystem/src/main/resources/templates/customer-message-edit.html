<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>vip顾客信息修改页面</title>
  <meta content="webkit" name="renderer">
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <meta content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi"
        name="viewport"/>
  <link th:href="@{/css/font.css}" rel="stylesheet">
  <link th:href="@{/css/xadmin.css}" rel="stylesheet">
  <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
  <script charset="utf-8" th:src="@{/lib/layui/layui.js}"></script>
  <script th:src="@{/js/xadmin.js}" type="text/javascript"></script>
  <!--[if lt IE 9]>
  <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
  <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="layui-main" style="text-align: center">
  <div id="LAY_preview">
    <div class="layui-form layui-border-box layui-table-view">
      <div class="layui-table-box layui-inline">
        <div class="layui-table-body">
          <form class="layui-form layui-form-pane" action="">
            <input hidden="hidden" value="" name="registerInfo_customerId">
            <table border="0" cellpadding="0" cellspacing="0" class="layui-table"
                   style="text-align: center;width: 800px;">
              <tbody>
              <tr>
                <td colspan="10">视力美会员档案</td>
              </tr>
              <tr>
                <td>会员ID</td>
                <td colspan="6" th:text="${customer.customer_id}"></td>
                <td>生日</td>
                <td colspan="2" th:text="${customer.customer_birthday}"></td>
              </tr>
              <tr>
                <td>姓名</td>
                <td th:text="${customer.customer_name}"></td>
                <td>性别</td>
                <td th:text="${customer.customer_sex}"></td>
                <td>年龄</td>
                <td th:text="${age}"></td>
                <td>所在学校</td>
                <td colspan="3" th:text="${customer.customer_schoolName}"></td>
              </tr>
              <tr>
                <td>戴镜史</td>
                <td th:text="${customer.customer_history}"></td>
                <td>瞳距</td>
                <td colspan="3" th:text="'左眼瞳距：'+${customer.customer_PDLeft}+'，右眼瞳距：'+${customer.customer_PDRight}"></td>
                <td>家庭住址</td>
                <td colspan="3" th:text="${customer.customer_address}"></td>
              </tr>
              <tr>
                <td colspan="3">裸眼视力</td>
                <td colspan="3">矫正视力</td>
                <td rowspan="2">配镜参数</td>
                <td colspan="3" rowspan="2" th:text="${customer.customer_glassesDegree}"></td>
              </tr>
              <tr>
                <td th:text="'R:'+${customer.customer_visionRight}"></td>
                <td colspan="2" th:text="'L:'+${customer.customer_visionLeft}"></td>
                <td colspan="2">5.0</td>
                <td>5.0</td>
              </tr>
              <tr>
                <td>配镜日期</td>
                <td colspan="2" th:text="${customer.customer_createOrderDate}"></td>
                <td>镜架型号</td>
                <td colspan="2" th:text="${customer.customer_framesType}"></td>
                <td>镜片型号</td>
                <td colspan="3" th:text="${customer.customer_glassesType}"></td>
              </tr>
              <tr>
                <td>取镜日期</td>
                <td colspan="2" th:text="${customer.customer_getOrderDate}"></td>
                <td>联系方式</td>
                <td>母亲</td>
                <td colspan="2">
                  <input type="text" style="border: none" name="customer_parentMomPhoneNumber"
                         lay-verify="customer_parentMomPhoneNumber" th:value="${customer.customer_parentMomPhoneNumber}">
                </td>
                <td>父亲</td>
                <td colspan="2">
                  <input type="text" style="border: none" name="customer_parentDadPhoneNumber"
                         lay-verify="customer_parentDadPhoneNumber" th:value="${customer.customer_parentDadPhoneNumber}">
                </td>
              </tr>
              <tr>
                <td>验光师编号</td>
                <td colspan="2" th:text="${customer.customer_userId}"></td>
                <td>验光师</td>
                <td colspan="2" th:text="${customer.customer_userName}"></td>
                <td>身高</td>
                <td>
                  <input type="text" style="border: none;width: 80px;" name="customer_height"
                         lay-verify="customer_height" th:value="${customer.customer_height}">
                </td>
                <td>体重</td>
                <td>
                  <input type="text" style="border: none;width: 80px;" name="customer_weight"
                         lay-verify="customer_weight" th:value="${customer.customer_weight}">
                </td>
                <input hidden="hidden" th:value="${customer.customer_id}" name="customer_id">
              </tr>
              <tr>
              <td>建议理疗方案:</td>
              <td colspan="9">
                <input type="text" name="customer_physicalTherapyAdvice" lay-verify="customer_physicalTherapyAdvice"
                       style="width: 743px;height: 56px;border: none" th:value="${customer.customer_physicalTherapyAdvice}">
              </td>
              </tr>
              <tr>
                <td>其他检查备注:</td>
                <td colspan="9">
                  <input type="text" name="customer_remarks" lay-verify="customer_remarks"
                         style="width: 743px;height: 56px;border: none" th:value="${customer.customer_remarks}">
                </td>
              </tr>
              <tr>
                <td colspan="6">
                  <button class="layui-btn" lay-filter="submit" lay-submit="">提交</button>
                </td>
                <td colspan="5">
                  <button type="reset" class="layui-btn">重置</button>
                </td>
              </tr>
              </tbody>
            </table>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
<script>
  layui.use(['form'], function () {
    form = layui.form;
    form.verify({
      customer_parentMomPhoneNumber:[/^\d{11}$/,'请输入正确的手机号'],
      customer_parentDadPhoneNumber:[/^\d{11}$/,'请输入正确的手机号'],
      customer_height:[/^\d{2,}$/,'请输入正确的身高单位cm'],
      customer_weight:[/^\d{2,}$/,'请输入正确的体重单位kg'],
      customer_physicalTherapyAdvice:[/^.{1,20}$/,'请输入方案'],
      customer_remarks:[/^.{1,20}$/,'请输入备注']
    });

    form.on('submit(submit)',
            function (data) {
              console.log(data);
              completeInfo(data.field);
              return false;
            });
  });


  function completeInfo(data) {
    $.ajax({
      type: "POST",
      // dataType:"json",
      data: data,
      url: "http://localhost:9911/user/customer/completeInfo",
      success: function (data) {
        layer.alert("修改成功", {
                  icon: 6
                },
                function () {
                  // 获得frame索引
                  var index = parent.layer.getFrameIndex(window.name);
                  //关闭当前frame
                  parent.layer.close(index);
                  parent.location.reload();
                });
      },
      error: function (message) {
        layer.alert("修改失败", {
                  icon: 5
                },
                function () {
                  // 获得frame索引
                  var index = parent.layer.getFrameIndex(window.name);
                  //关闭当前frame
                  parent.layer.close(index);
                  parent.location.reload();
                });
      }
    })
  }
</script>
</html>